<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indophiles Network</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&display=swap" rel="stylesheet">

    <style>
        body { background: #000; color: #fff; margin: 0; font-family: 'Space Grotesk', sans-serif; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        
        header { padding: 10px 20px; background: #111; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; height: 50px; }
        h1 { margin: 0; font-size: 1.2rem; color: #ff9800; text-transform: uppercase; letter-spacing: 2px; }
        
        #search { padding: 5px 10px; background: #222; border: 1px solid #444; color: #fff; border-radius: 4px; }

        /* Force height to ensure visibility */
        #mynetwork { width: 100%; height: 60vh; background: #050505; border-bottom: 2px solid #333; }
        #mytimeline { width: 100%; height: 30vh; background: #111; }

        /* Error Log Styling */
        #status { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: red; font-size: 1.5rem; text-align: center; display: none; }
    </style>
</head>
<body>

<header>
    <h1>Indophiles Network</h1>
    <input type="text" id="search" placeholder="Search..." onkeyup="searchNode()">
</header>

<div id="status">Loading...</div>
<div id="mynetwork"></div>
<div id="mytimeline"></div>

<script type="text/javascript">
    // Error Trapping
    window.onerror = function(msg, url, line) {
        document.getElementById('status').style.display = 'block';
        document.getElementById('status').innerHTML = "ERROR:<br>" + msg;
        return false;
    };

    // 1. DATA
    const thinkers = [
        {id:1, name:"Dhanvantari", field:"Medicine", year:-3000, group:"india", note:"God of Medicine"},
        {id:2, name:"Vyasa", field:"Literature", year:-1500, group:"india", note:"Compiler of Vedas"},
        {id:5, name:"Kapila", field:"Philosophy", year:-600, group:"india", note:"Samkhya Founder"},
        {id:7, name:"Buddha", field:"Philosophy", year:-563, group:"india", note:"Buddhism Founder"},
        {id:9, name:"Panini", field:"Linguistics", year:-500, group:"india", note:"Grammar Code"},
        {id:11, name:"Chanakya", field:"Statecraft", year:-350, group:"india", note:"Arthashastra"},
        {id:12, name:"Megasthenes", field:"History", year:-350, group:"west", note:"Indica"},
        {id:23, name:"Aryabhata", field:"Math", year:476, group:"india", note:"Zero and Pi"},
        {id:28, name:"Adi Shankara", field:"Philosophy", year:788, group:"india", note:"Advaita Vedanta"},
        {id:29, name:"Al-Biruni", field:"Indology", year:973, group:"west", note:"Indica"},
        {id:33, name:"Marco Polo", field:"Traveler", year:1288, group:"west", note:"Travels"},
        {id:43, name:"Voltaire", field:"Indology", year:1694, group:"west", note:"Admirer of Vedas"},
        {id:44, name:"William Jones", field:"Indology", year:1746, group:"west", note:"Indo-European Link"},
        {id:45, name:"Schopenhauer", field:"Indology", year:1788, group:"west", note:"Upanishads Admirer"},
        {id:47, name:"Vivekananda", field:"Philosophy", year:1863, group:"india", note:"Vedanta to West"},
        {id:49, name:"Nikola Tesla", field:"Science", year:1856, group:"west", note:"Vedic Prana/Akasha"},
        {id:51, name:"Schrodinger", field:"Science", year:1887, group:"west", note:"Quantum Vedanta"},
        {id:52, name:"Oppenheimer", field:"Science", year:1904, group:"west", note:"Gita at Trinity"},
        {id:55, name:"Steve Jobs", field:"Tech", year:1955, group:"west", note:"Yogi Autobiography"}
    ];

    // 2. SETUP
    const nodes = [];
    const edges = [];
    const fields = {};

    thinkers.forEach(function(p) {
        // Create Field Hub
        if (!fields[p.field]) {
            fields[p.field] = true;
            nodes.push({id: "f_" + p.field, label: p.field, group: "field", shape: "diamond", size: 10});
        }
        // Create Person
        nodes.push({id: p.id, label: p.name, group: p.group, title: p.note, value: 20});
        // Create Edge
        edges.push({from: p.id, to: "f_" + p.field});
    });

    const container = document.getElementById('mynetwork');
    const data = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
    const options = {
        nodes: { shape: 'dot', font: {color: '#fff'} },
        groups: {
            india: { color: '#ff9800' },
            west: { color: '#00bcd4' },
            field: { color: '#333' }
        },
        physics: { stabilization: false, barnesHut: { gravitationalConstant: -2000 } }
    };

    // 3. DRAW NETWORK
    const network = new vis.Network(container, data, options);

    // 4. DRAW TIMELINE
    const items = new vis.DataSet(thinkers.map(function(t) {
        return { id: t.id, content: t.name, start: new Date(0, 0, 0).setFullYear(t.year) };
    }));

    const timeline = new vis.Timeline(document.getElementById('mytimeline'), items, {
        height: '100%', 
        start: new Date(0, 0, 0).setFullYear(1800), 
        end: new Date(0, 0, 0).setFullYear(2000),
        style: 'background: #111; color: #ccc; border: none'
    });

    // 5. INTERACTION
    network.on("click", function(params) {
        if (params.nodes.length) {
            var id = params.nodes[0];
            if (typeof id === 'string') return; // Skip fields
            var item = items.get(id);
            timeline.moveTo(item.start);
            timeline.setSelection(id);
        }
    });

    window.searchNode = function() {
        var q = document.getElementById('search').value.toLowerCase();
        if (!q) return;
        var found = thinkers.find(function(t) { return t.name.toLowerCase().includes(q); });
        if (found) {
            network.selectNodes([found.id]);
            network.focus(found.id, {scale: 1.5, animation: true});
            timeline.setSelection(found.id);
            timeline.moveTo(new Date(0, 0, 0).setFullYear(found.year));
        }
    };
    
    // Hide status if successful
    document.getElementById('status').style.display = 'none';

</script>
</body>
</html>
